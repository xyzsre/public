---
- name: Ensure IP routing is enabled on switches
  hosts: vios
  gather_facts: no
  collections:
    - cisco.ios

  tasks:
    - name: Enable ip routing
      cisco.ios.ios_config:
        lines:
          - ip routing

    - name: Verify ip routing in running configuration
      cisco.ios.ios_command:
        commands:
          - show running-config | include ^ip routing
      register: verify_routing

    - name: Display verification result
      ansible.builtin.debug:
        msg: |-
          Host: {{ inventory_hostname }}
          {{ verify_routing.stdout[0] | default('ip routing not found') }}
